-- Créer le ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
screenGui.ResetOnSpawn = false

-- Créer un Frame pour contenir les boutons
local frame = Instance.new("Frame")
frame.Parent = screenGui
frame.Size = UDim2.new(0, 350, 0, 400)
frame.Position = UDim2.new(0.5, -175, 0.5, -200)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.BorderSizePixel = 0
frame.Visible = true

-- Fonction pour styliser les boutons
local function createButton(text, position, parent)
    local button = Instance.new("TextButton")
    button.Parent = parent
    button.Size = UDim2.new(0, 300, 0, 50)
    button.Position = position
    button.Text = text
    button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 18
    button.BorderSizePixel = 0
    return button
end

-- Création des boutons
local autoCoinButton = createButton("Activate Auto Coin", UDim2.new(0, 25, 0, 20), frame)
local autoDummyButton = createButton("Activate Auto Dummy 5k", UDim2.new(0, 25, 0, 80), frame)
local hitboxButton = createButton("Show/Hide Hitboxes", UDim2.new(0, 25, 0, 140), frame)
local spamWeaponButton = createButton("Activate Spam Weapon", UDim2.new(0, 25, 0, 200), frame)
local farmKillButton = createButton("Activate Farm Kill", UDim2.new(0, 25, 0, 260), frame)

-- Fonction pour activer/désactiver un bouton
local function toggleButton(button, state, scriptName)
    if state then
        button.Text = "Deactivate " .. scriptName
    else
        button.Text = "Activate " .. scriptName
    end
end

-- **Auto Coin Script**
local autoCollect = false
autoCoinButton.MouseButton1Click:Connect(function()
    autoCollect = not autoCollect
    toggleButton(autoCoinButton, autoCollect, "Auto Coin")
    if autoCollect then
        spawn(function()
            while autoCollect do
                game:GetService("ReplicatedStorage").Events.CoinEvent:FireServer()
                task.wait(0.1)
            end
        end)
    end
end)

-- **Auto Dummy 5k Level Script** (remplacé par ton script)
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- RemoteEvent pour tirer la fireball
local FireballEvent = ReplicatedStorage:WaitForChild("SkillsInRS"):WaitForChild("RemoteEvent")

-- RemoteEvent pour hit le dummy
local HitEvent = ReplicatedStorage:WaitForChild("jdskhfsIIIllliiIIIdchgdIiIIIlIlIli")

-- Coordonnées du tir (modifiable pour suivre un ennemi)
local fireballPosition = Vector3.new(-83.33870697021484, 595.9384765625, 812.44775390625)
local projectileType = "NewFireball"

-- Cible du hit (assure-toi que ce chemin est valide)
local dummyHumanoid = workspace:FindFirstChild("MAP"):FindFirstChild("5k_dummies").Dummy2:FindFirstChild("Humanoid")

-- Délais
local fireballCooldown = 2 -- Temps entre chaque tir
local hitCooldown = 0.1 -- Temps entre chaque hit

-- Fonction pour tirer les fireballs en boucle
task.spawn(function()
    while true do
        local fireballArgs = {
            [1] = fireballPosition,
            [2] = projectileType
        }
        FireballEvent:FireServer(unpack(fireballArgs))
        task.wait(fireballCooldown)
    end
end)

-- Fonction pour spammer les hits sur le dummy
task.spawn(function()
    while true do
        local hitArgs = {
            [1] = dummyHumanoid,
            [2] = 1 -- Dégâts ou autre paramètre
        }
        HitEvent:FireServer(unpack(hitArgs))
        task.wait(hitCooldown)
    end
end)

-- **Hitbox Script**
local hitboxActive = false
hitboxButton.MouseButton1Click:Connect(function()
    hitboxActive = not hitboxActive
    toggleButton(hitboxButton, hitboxActive, "Hitbox")
    if hitboxActive then
        -- Afficher les hitboxes (ajouter la logique pour afficher les hitboxes ici)
        print("Hitboxes activated")
    else
        -- Masquer les hitboxes
        print("Hitboxes deactivated")
    end
end)

-- **Spam Weapon Script** (remplacé par ton script)
local event = game:GetService("ReplicatedStorage").Events.WeaponEvent
local unequipArgs1 = { [1] = "None" }
local unequipArgs2 = { [1] = "S0" }

-- Fonction pour cacher le menu des armes
local function hideWeaponMenu()
    local player = game:GetService("Players").LocalPlayer
    if player and player:FindFirstChild("PlayerGui") then
        for _, gui in pairs(player.PlayerGui:GetChildren()) do
            if gui:IsA("ScreenGui") and gui.Name:lower():find("weapon") then
                gui.Enabled = false
            end
        end
    end
end

while true do
    for i = 1, 9 do -- Seulement de S1 à S9
        local args = { [1] = "S" .. i }

        -- Cache le menu avant chaque action
        hideWeaponMenu()

        -- Équipe l'arme
        event:FireServer(unpack(args))
        task.wait(0.15) -- Délai rapide

        -- Déséquipe l'arme avec les deux méthodes
        event:FireServer(unpack(unequipArgs1))
        task.wait(0.1) -- Encore plus rapide
        event:FireServer(unpack(unequipArgs2))
        task.wait(0.1)

        -- Cache à nouveau le menu pour éviter qu'il réapparaisse
        hideWeaponMenu()
    end
end

-- **Farm Kill Script** (remplacé par ton script)
local farmKillActive = false
farmKillButton.MouseButton1Click:Connect(function()
    farmKillActive = not farmKillActive
    toggleButton(farmKillButton, farmKillActive, "Farm Kill")
    if farmKillActive then
        spawn(function()
            local player = game:GetService("Players").LocalPlayer
            local replicatedStorage = game:GetService("ReplicatedStorage")
            local character, humanoid

            -- Fonction pour téléporter le joueur aux 5k_dummies
            local function teleportToDummies()
                character = player.Character or player.CharacterAdded:Wait()

                if character then
                    local dummiesFolder = workspace:FindFirstChild("MAP") and workspace.MAP:FindFirstChild("5k_dummies")
                    if dummiesFolder then
                        local targetDummy = dummiesFolder:FindFirstChild("Dummy2") -- Modifier si besoin

                        if targetDummy and targetDummy:FindFirstChild("HumanoidRootPart") then
                            -- Téléportation au dummy
                            character:MoveTo(targetDummy.HumanoidRootPart.Position + Vector3.new(0, 3, 0)) -- +3 pour éviter les collisions
                            return true -- Retourne vrai si la téléportation a réussi
                        end
                    end
                end
                return false -- Retourne faux si la téléportation a échoué
            end

            -- Fonction pour appliquer le hit et tuer instantanément le joueur
            local function autoKill()
                character = player.Character
                humanoid = character and character:FindFirstChild("Humanoid")

                if humanoid then
                    -- Téléporter et s'assurer que la téléportation est bien faite
                    local success = teleportToDummies()

                    if success then
                        -- Attendre un court instant pour être sûr que le joueur est bien sur la position
                        task.wait(1) 

                        -- Ajouter 1 hit sur soi-même
                        local hitArgs = {
                            [1] = humanoid,
                            [2] = 1
                        }
                        replicatedStorage.jdskhfsIIIllliiIIIdchgdIiIIIlIlIli:FireServer(unpack(hitArgs))

                        -- Attendre un petit instant pour que le hit soit bien enregistré
                        task.wait(0.3)

                        -- Tue instantanément le joueur
                        humanoid.Health = 0

                        -- Envoyer le Remote Event pour comptabiliser le kill
                        local killArgs = {
                            [1] = humanoid,
                            [2] = 40206 -- Score du kill
                        }
                        replicatedStorage.SkillsInRS.DamageIndicatorEvent:FireServer(unpack(killArgs))
                    end
                end
            end

            -- Forçage du respawn immédiat
            local function forceRespawn()
                if player then
                    task.wait(0.1) -- Court délai pour éviter des erreurs de chargement
                    player:LoadCharacter() -- Respawn instantanément
                end
            end

            -- Exécuter l'auto-kill après la téléportation complète
            player.CharacterAdded:Connect(function()
                task.wait(0.5) -- Laisser le temps au personnage de charger
                autoKill() -- Exécuter immédiatement l'auto-kill après le spawn
            end)

            -- Détecter la mort et forcer le respawn immédiat
            player.CharacterRemoving:Connect(function()
                task.wait(0.1) -- Petit délai pour éviter les erreurs
                forceRespawn() -- Forcer le respawn
            end)

            -- Lancer immédiatement au début
            autoKill()
        end)
    end
end)

-- **Ajout du bouton pour Open/Close le menu**
local openGUIButton = createButton("Open GUI", UDim2.new(0, 10, 0, 10), screenGui)
openGUIButton.Size = UDim2.new(0, 120, 0, 40)
openGUIButton.Visible = false -- Masqué au début

local function toggleGUI()
    frame.Visible = not frame.Visible
    openGUIButton.Visible = not frame.Visible
end

local toggleGUIButton = createButton("Close GUI", UDim2.new(0, 25, 0, 320), frame)
toggleGUIButton.MouseButton1Click:Connect(toggleGUI)
openGUIButton.MouseButton1Click:Connect(toggleGUI)
